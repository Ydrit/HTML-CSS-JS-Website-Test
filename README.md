Credit to Brian Design who provided this class, he's the true hero.